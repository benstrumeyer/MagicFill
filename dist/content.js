(()=>{"use strict";class e{constructor(){this.patterns=[{type:"firstName",patterns:[/first.*name/i,/fname/i,/given.*name/i],priority:10},{type:"lastName",patterns:[/last.*name/i,/lname/i,/surname/i,/family.*name/i],priority:10},{type:"fullName",patterns:[/^name$/i,/full.*name/i,/your.*name/i],priority:9},{type:"email",patterns:[/email/i,/e-mail/i],priority:10},{type:"phone",patterns:[/phone/i,/mobile/i,/telephone/i,/contact.*number/i],priority:10},{type:"address",patterns:[/^address$/i,/street.*address/i,/address.*line.*1/i],priority:10},{type:"address2",patterns:[/address.*line.*2/i,/apt/i,/suite/i,/unit/i],priority:9},{type:"city",patterns:[/city/i,/town/i],priority:10},{type:"state",patterns:[/state/i,/province/i,/region/i],priority:10},{type:"zipCode",patterns:[/zip/i,/postal/i,/postcode/i],priority:10},{type:"country",patterns:[/country/i],priority:10},{type:"currentCompany",patterns:[/current.*company/i,/employer/i,/organization/i],priority:9},{type:"currentTitle",patterns:[/current.*title/i,/job.*title/i,/position/i,/role/i],priority:9},{type:"yearsExperience",patterns:[/years.*experience/i,/experience.*years/i,/yoe/i],priority:9},{type:"linkedin",patterns:[/linkedin/i,/linkedin.*url/i,/linkedin.*profile/i],priority:10},{type:"github",patterns:[/github/i,/github.*url/i,/github.*profile/i],priority:10},{type:"portfolio",patterns:[/portfolio/i,/website/i,/personal.*site/i],priority:9},{type:"university",patterns:[/university/i,/college/i,/school/i,/education/i],priority:9},{type:"degree",patterns:[/degree/i,/qualification/i],priority:9},{type:"major",patterns:[/major/i,/field.*study/i,/specialization/i],priority:9},{type:"graduationYear",patterns:[/graduation/i,/grad.*year/i,/year.*graduated/i],priority:9},{type:"workAuthorization",patterns:[/work.*authorization/i,/authorized.*work/i,/visa.*status/i,/sponsorship/i],priority:9},{type:"requiresSponsorship",patterns:[/require.*sponsorship/i,/need.*sponsorship/i,/visa.*sponsorship/i],priority:9},{type:"salaryExpectation",patterns:[/salary/i,/compensation/i,/expected.*salary/i],priority:8},{type:"startDate",patterns:[/start.*date/i,/available.*date/i,/availability/i],priority:8},{type:"noticePeriod",patterns:[/notice.*period/i,/notice/i],priority:8},{type:"referral",patterns:[/referral/i,/referred.*by/i,/reference/i],priority:8},{type:"howDidYouHear",patterns:[/how.*hear/i,/source/i,/where.*find/i],priority:7},{type:"coverLetter",patterns:[/cover.*letter/i,/why.*interested/i,/tell.*us.*about/i],priority:7},{type:"additionalInfo",patterns:[/additional/i,/other.*information/i,/comments/i,/notes/i],priority:6}]}getFieldContext(e){const t=[];if(e.id){const o=document.querySelector(`label[for="${e.id}"]`);o?.textContent&&t.push(o.textContent.trim())}const o=e.getAttribute("aria-label");o&&t.push(o),"placeholder"in e&&e.placeholder&&t.push(e.placeholder),e.name&&t.push(e.name),e.id&&t.push(e.id);const n=e.closest("label");return n?.textContent&&t.push(n.textContent.replace(e.value||"","").trim()),t.join(" ")}matchField(e){let t=null;for(const o of this.patterns)for(const n of o.patterns)n.test(e)&&(!t||o.priority>t.priority)&&(t={type:o.type,priority:o.priority});return t?.type||null}matchFieldToMapping(e,t){const o=e.toLowerCase();for(const[e,n]of Object.entries(t))for(const t of n.patterns)if(o.includes(t.toLowerCase()))return console.log(`  âœ“ Mapping matched: "${e}" via pattern "${t}"`),e;return null}findAllFields(){const e=[];return document.querySelectorAll('input:not([type="hidden"]):not([type="submit"]):not([type="button"]), textarea, select').forEach(t=>{const o=t;if(o.disabled)return;if("readOnly"in o&&o.readOnly)return;const n=this.getFieldContext(o);let s=this.matchField(n);o instanceof HTMLInputElement&&"file"===o.type&&(s=this.detectFileType(n));const i=this.generateSelector(o);e.push({element:o,selector:i,type:s||"unknown",context:n,value:o.value||"",fieldType:o.tagName.toLowerCase(),inputType:o instanceof HTMLInputElement?o.type:void 0})}),e}detectFileType(e){const t=e.toLowerCase();return/resume|cv/i.test(t)?"resumeUpload":/cover.*letter/i.test(t)?"coverLetterUpload":/transcript/i.test(t)?"transcriptUpload":/portfolio|sample|work/i.test(t)?"portfolioUpload":"fileUpload"}generateSelector(e){if(e.id)return`#${e.id}`;if(e instanceof HTMLInputElement&&e.name)return`input[name="${e.name}"]`;if(e instanceof HTMLTextAreaElement&&e.getAttribute("name"))return`textarea[name="${e.getAttribute("name")}"]`;if(e instanceof HTMLSelectElement&&e.name)return`select[name="${e.name}"]`;const t=e.parentElement;if(t){const o=Array.from(t.children).filter(t=>t.tagName===e.tagName).indexOf(e)+1;return`${e.tagName.toLowerCase()}:nth-of-type(${o})`}return e.tagName.toLowerCase()}}class t{fillField(e,t){try{const o=e.element;return!(!o||o.disabled)&&(!("readOnly"in o)||!o.readOnly)&&(o instanceof HTMLInputElement?this.fillInput(o,t):o instanceof HTMLTextAreaElement?this.fillTextarea(o,t):o instanceof HTMLSelectElement&&this.fillSelect(o,t))}catch(e){return console.error("Error filling field:",e),!1}}fillInput(e,t){switch(e.type){case"text":case"email":case"tel":case"url":case"number":case"date":return e.value=String(t),this.triggerEvents(e),this.highlightField(e),!0;case"checkbox":return e.checked=Boolean(t),this.triggerEvents(e),this.highlightField(e),!0;case"radio":return e.value===String(t)&&(e.checked=!0,this.triggerEvents(e),this.highlightField(e),!0);default:return!1}}fillTextarea(e,t){return e.value=t,this.triggerEvents(e),this.highlightField(e),!0}fillSelect(e,t){for(let o=0;o<e.options.length;o++){const n=e.options[o];if(n.value===t||n.text===t)return e.selectedIndex=o,this.triggerEvents(e),this.highlightField(e),!0}const o=t.toLowerCase();for(let t=0;t<e.options.length;t++){const n=e.options[t];if(n.value.toLowerCase().includes(o)||n.text.toLowerCase().includes(o))return e.selectedIndex=t,this.triggerEvents(e),this.highlightField(e),!0}return!1}triggerEvents(e){e.dispatchEvent(new Event("input",{bubbles:!0})),e.dispatchEvent(new Event("change",{bubbles:!0})),e.dispatchEvent(new Event("blur",{bubbles:!0}))}highlightField(e){const t=e.style.border,o=e.style.backgroundColor,n=e.style.color;e.style.border="2px solid #4CAF50",e.style.backgroundColor="#E8F5E9",e.style.color="#000000",setTimeout(()=>{e.style.border=t,e.style.backgroundColor=o,e.style.color=n},1e3)}highlightFieldGreen(e){this.highlightField(e)}highlightUnrecognizedField(e){const t=e.style.border,o=e.style.backgroundColor,n=e.style.color;e.style.border="2px solid #f44336",e.style.backgroundColor="#ffebee",e.style.color="#000000",setTimeout(()=>{e.style.border=t,e.style.backgroundColor=o,e.style.color=n},2e3)}fillAllFields(e,t,o){console.log("=== FILL ALL FIELDS ==="),console.log("Total fields found:",e.length),console.log("Custom answers available:",Object.keys(t.customAnswers||{}).length),console.log("Custom answer keys:",Object.keys(t.customAnswers||{}));let n=0;const s=[],i=[];for(const r of e){if(console.log("\nProcessing field:",{selector:r.selector,type:r.type,context:r.context,fieldType:r.fieldType}),"file"===r.inputType){console.log("â†’ File upload, skipping"),i.push(r),this.highlightFileUpload(r.element);continue}console.log("â†’ Getting value for type:",r.type||"unknown");const e=this.getValueForField(r.type||"unknown",t,r,o);console.log("â†’ Value found:",e),null!=e&&""!==e?this.fillField(r,e)&&n++:(console.log("â†’ No value found, marking as unrecognized"),s.push(r),this.highlightUnrecognizedField(r.element))}return i.length>0&&this.showFileUploadNotification(i),{filled:n,total:e.length,unrecognized:s}}highlightFileUpload(e){const t=e.style.border,o=e.style.backgroundColor,n=e.style.color;e.style.border="2px solid #2196F3",e.style.backgroundColor="#E3F2FD",e.style.color="#000000",setTimeout(()=>{e.style.border=t,e.style.backgroundColor=o,e.style.color=n},3e3)}showFileUploadNotification(e){const t=e.map(e=>"resumeUpload"===e.type?"Resume":"coverLetterUpload"===e.type?"Cover Letter":"transcriptUpload"===e.type?"Transcript":"portfolioUpload"===e.type?"Portfolio":"File"),o=`ðŸ“Ž Please upload: ${[...new Set(t)].join(", ")}`,n=document.createElement("div");n.style.cssText="\n      position: fixed;\n      top: 80px;\n      right: 20px;\n      padding: 16px 24px;\n      background: #2196F3;\n      color: white;\n      border-radius: 8px;\n      box-shadow: 0 4px 12px rgba(0,0,0,0.3);\n      z-index: 999999;\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n      font-size: 14px;\n      max-width: 300px;\n      animation: slideIn 0.3s ease-out;\n    ",n.textContent=o,document.body.appendChild(n),setTimeout(()=>{n.style.animation="slideOut 0.3s ease-out",setTimeout(()=>n.remove(),300)},5e3)}matchContextToCustomAnswers(e,t){console.log("  Fuzzy matching context:",e),console.log("  Against keys:",Object.keys(t));const o=e.toLowerCase(),n=o.replace(/[^a-z0-9]/g,"");for(const e of Object.keys(t))if(e.toLowerCase().replace(/[^a-z0-9]/g,"")===n)return console.log("  âœ“ Exact normalized match found:",e),e;for(const e of Object.keys(t)){const t=e.toLowerCase().replace(/([A-Z])/g," $1").toLowerCase().split(/\s+/).filter(e=>e.length>2),n=o.split(/\s+/).filter(e=>e.length>2);console.log(`  Checking key "${e}":`,{keyWords:t,contextWords:n});const s=t.filter(e=>n.some(t=>t.includes(e)||e.includes(t))).length,i=Math.max(1,Math.ceil(.5*t.length));if(console.log(`  Match count: ${s}/${t.length}, threshold: ${i}`),s>=i&&t.length>0)return console.log("  âœ“ Fuzzy match found:",e),e}return console.log("  âœ— No match found"),null}getValueForField(e,t,o,n){if(o&&t.fieldMappings&&n){const e=n.matchFieldToMapping(o.context,t.fieldMappings);if(e&&t.fieldMappings[e])return console.log(`  âœ“ Using field mapping: ${e} = ${t.fieldMappings[e].value}`),t.fieldMappings[e].value}if(t.customAnswers&&t.customAnswers[e])return t.customAnswers[e];if("unknown"===e&&o&&t.customAnswers){const e=this.matchContextToCustomAnswers(o.context,t.customAnswers);if(e)return t.customAnswers[e]}switch(e){case"firstName":return t.firstName;case"lastName":return t.lastName;case"fullName":return`${t.firstName} ${t.lastName}`;case"email":return t.email;case"phone":return t.phone;case"address":return t.address;case"address2":return t.address2||"";case"city":return t.city;case"state":return t.state;case"zipCode":return t.zipCode;case"country":return t.country;case"currentCompany":return t.currentCompany||"";case"currentTitle":return t.currentTitle||"";case"yearsExperience":return t.yearsExperience?.toString()||"";case"linkedin":return t.linkedin||"";case"github":return t.github||"";case"portfolio":return t.portfolio||"";case"university":return t.university||"";case"degree":return t.degree||"";case"major":return t.major||"";case"graduationYear":return t.graduationYear?.toString()||"";case"workAuthorization":return t.workAuthorization||"";case"requiresSponsorship":return t.requiresSponsorship??!1;case"salaryExpectation":return t.salaryExpectation||"";case"startDate":return t.startDate||"";case"noticePeriod":return t.noticePeriod||"";case"referral":return t.referral||"";case"howDidYouHear":return t.howDidYouHear||"";case"coverLetter":return t.coverLetter||"";case"additionalInfo":return t.additionalInfo||"";default:return null}}}class o{async get(e){return new Promise(t=>{chrome.storage.local.get([e],o=>{t(o[e]||null)})})}async set(e,t){return new Promise(o=>{chrome.storage.local.set({[e]:t},()=>{o()})})}async getPersonalData(){const e=await this.get("personalData");if(!e||0===Object.keys(e).length||!e.firstName){const e=await this.loadDevData();if(e)return console.log("Storage: Loaded dev-data.json for testing"),await this.setPersonalData(e),e}const t=e||this.getDefaultPersonalData();return t.fieldMappings||(t.fieldMappings=await this.loadFieldMappings()),t}async loadFieldMappings(){try{const e=await fetch(chrome.runtime.getURL("field-mappings.json"));if(e.ok){const t=await e.json();return console.log("Storage: Loaded field-mappings.json"),t}}catch(e){console.log("Storage: No field-mappings.json found")}return{}}async loadDevData(){try{const e=await fetch(chrome.runtime.getURL("dev-data.json"));if(e.ok)return await e.json()}catch(e){console.log("Storage: No dev-data.json found (this is normal for production)")}return null}async setPersonalData(e){await this.set("personalData",e)}async addAnswer(e,t,o=!1){const n=await this.getPersonalData();if(n.customAnswers||(n.customAnswers={}),o){const o=window.location.hostname;n.siteSpecificAnswers||(n.siteSpecificAnswers={}),n.siteSpecificAnswers[o]||(n.siteSpecificAnswers[o]={}),n.siteSpecificAnswers[o][e]=t}else n.customAnswers[e]=t;await this.setPersonalData(n)}getDefaultPersonalData(){return{firstName:"",lastName:"",email:"",phone:"",address:"",address2:"",city:"",state:"",zipCode:"",country:"United States",currentCompany:"",currentTitle:"",yearsExperience:0,linkedin:"",github:"",portfolio:"",university:"",degree:"",major:"",graduationYear:0,workAuthorization:"",requiresSponsorship:!1,salaryExpectation:"",startDate:"",noticePeriod:"",referral:"",howDidYouHear:"",coverLetter:"",additionalInfo:"",customAnswers:{},siteSpecificAnswers:{}}}async exportData(){const e=await this.getPersonalData();return JSON.stringify(e,null,2)}async importData(e){try{const t=JSON.parse(e);await this.setPersonalData(t)}catch(e){throw new Error("Invalid JSON format")}}async deleteAnswer(e,t=!1,o){const n=await this.getPersonalData();t&&o&&n.siteSpecificAnswers?.[o]?delete n.siteSpecificAnswers[o][e]:n.customAnswers&&delete n.customAnswers[e],await this.setPersonalData(n)}}class n{constructor(e="http://localhost:3000"){this.baseUrl=e}async isServerRunning(){try{return(await fetch(`${this.baseUrl}/health`,{method:"GET",signal:AbortSignal.timeout(2e3)})).ok}catch(e){return!1}}async scanPage(e){const t=await fetch(`${this.baseUrl}/scan`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:e})});if(!t.ok)throw new Error(`MCP scan failed: ${t.statusText}`);return await t.json()}async updateConfig(e,t){const o=await fetch(`${this.baseUrl}/update-config`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:e,fields:t})});if(!o.ok)throw new Error(`MCP config update failed: ${o.statusText}`);return await o.json()}}new class{constructor(){this.lastFillResult=null,this.fieldMatcher=new e,this.formFiller=new t,this.storage=new o,this.mcpClient=new n,this.init()}async init(){chrome.runtime.onMessage.addListener((e,t,o)=>(this.handleMessage(e).then(o),!0)),window.MagicFillDebug={showStorage:async()=>{const e=await this.storage.getPersonalData();return console.log("=== MAGICFILL STORED DATA ==="),console.log("Custom Answers:",e.customAnswers),console.log("Field Mappings:",e.fieldMappings),console.log("Custom Answer Keys:",Object.keys(e.customAnswers||{})),console.log("Full Data:",e),e},clearStorage:async()=>{await this.storage.set("personalData",{}),console.log("Storage cleared!"),location.reload()}},console.log("ðŸŽ¯ MagicFill Content Script Loaded!"),console.log('ðŸ’¡ Debug: Type "MagicFillDebug.showStorage()" to see stored data'),setTimeout(()=>{this.autoFill()},1e3),this.observeDynamicForms()}async handleMessage(e){const t=e.action;return"fillForm"===t?await this.fillForm():"getUnrecognizedFields"===t?this.getUnrecognizedFields():"fillField"===t?e.payload?.selector&&e.payload?.value?await this.fillSingleField(e.payload.selector,e.payload.value):{success:!1,error:"Missing selector or value"}:"addAnswer"===t?e.payload?.key&&void 0!==e.payload?.value?(await this.storage.addAnswer(e.payload.key,e.payload.value,e.payload.siteSpecific||!1),{success:!0}):{success:!1,error:"Missing key or value"}:"learnForm"===t?await this.learnForm():{success:!1,error:"Unknown action"}}async learnForm(){try{if(!await this.mcpClient.isServerRunning())return{success:!1,error:"MCP server not running. Start it with: cd mcp-server && npm run dev"};if(this.showNotification("ðŸ” Learning form...","info"),!(await this.mcpClient.scanPage(window.location.href)).success)return{success:!1,error:"Failed to scan page"};const e=this.fieldMatcher.findAllFields(),t=await this.storage.getPersonalData(),o=this.formFiller.fillAllFields(e,t,this.fieldMatcher).unrecognized.map(e=>({key:this.generateKey(e.context),context:e.context,value:"",selector:e.selector}));return 0===o.length?(this.showNotification("âœ… All fields already recognized!","success"),{success:!0,fieldsLearned:0}):(sessionStorage.setItem("learnedFields",JSON.stringify(o)),this.showNotification(`âœ… Found ${o.length} new fields!`,"success"),{success:!0,fieldsLearned:o.length,openReview:!0})}catch(e){return console.error("Learn form error:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}generateKey(e){return e.toLowerCase().replace(/[^a-z0-9\s]/g,"").split(/\s+/).filter(e=>e.length>0).map((e,t)=>0===t?e:e.charAt(0).toUpperCase()+e.slice(1)).join("")}async autoFill(){try{const e=await this.fillForm();e.filled>0&&this.showNotification(`âœ¨ Filled ${e.filled}/${e.total} fields`,"success"),e.unrecognized.length>0&&this.showNotification(`â“ ${e.unrecognized.length} unrecognized fields`,"info")}catch(e){console.error("Auto-fill error:",e)}}async fillForm(){console.log("ðŸŽ¯ FILL FORM STARTED");const e=this.fieldMatcher.findAllFields();console.log("ðŸ“‹ Found fields:",e.length);const t=await this.storage.getPersonalData();console.log("ðŸ’¾ Personal data loaded"),console.log("  - Custom answers:",Object.keys(t.customAnswers||{}).length),console.log("  - Custom answer keys:",Object.keys(t.customAnswers||{})),console.log("  - Field mappings:",Object.keys(t.fieldMappings||{}).length);const o=this.formFiller.fillAllFields(e,t,this.fieldMatcher);this.lastFillResult=o,console.log("âœ… Fill complete:",{filled:o.filled,total:o.total,unrecognized:o.unrecognized.length});for(const e of o.unrecognized)this.addSaveButton(e);return o}addSaveButton(e){if(document.querySelector(`[data-magicfill-save="${e.selector}"]`))return;const t=document.createElement("button");t.className="magicfill-save-btn",t.setAttribute("data-magicfill-save",e.selector),t.innerHTML="ðŸ’¾ Save Answer",t.style.cssText="\n      position: absolute;\n      z-index: 999999;\n      padding: 6px 12px;\n      background: #6366f1;\n      color: white;\n      border: none;\n      border-radius: 4px;\n      font-size: 12px;\n      font-weight: 600;\n      cursor: pointer;\n      box-shadow: 0 2px 8px rgba(99, 102, 241, 0.3);\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n      transition: all 0.2s;\n    ",t.addEventListener("mouseenter",()=>{t.style.background="#5558e3",t.style.transform="translateY(-1px)",t.style.boxShadow="0 4px 12px rgba(99, 102, 241, 0.4)"}),t.addEventListener("mouseleave",()=>{t.style.background="#6366f1",t.style.transform="translateY(0)",t.style.boxShadow="0 2px 8px rgba(99, 102, 241, 0.3)"}),t.addEventListener("click",async o=>{o.preventDefault(),o.stopPropagation(),await this.saveFieldAnswer(e,t)});const o=e.element.getBoundingClientRect();t.style.top=window.scrollY+o.top-35+"px",t.style.left=`${window.scrollX+o.left}px`,document.body.appendChild(t);const n=()=>{const o=e.element.getBoundingClientRect();t.style.top=window.scrollY+o.top-35+"px",t.style.left=`${window.scrollX+o.left}px`};window.addEventListener("scroll",n),window.addEventListener("resize",n)}async saveFieldAnswer(e,t){console.log("=== SAVE FIELD ANSWER ==="),console.log("Field info:",{selector:e.selector,fieldType:e.fieldType,inputType:e.inputType});let o=document.querySelector(e.selector);if(o||(console.log("Selector failed, using original element"),o=e.element),!o)return console.log("ERROR: Element not found"),void this.showToast("âš ï¸ Field not found","error");console.log("Found element:",{tagName:o.tagName,value:o.value});let n=o.value;if(o instanceof HTMLInputElement&&!n){console.log("Input has no value, looking for hidden select...");const e=o.closest("div, fieldset, form");console.log("Parent element:",e?.tagName);let t=e?.querySelector("select");if(console.log("Hidden select in parent:",!!t),!t&&o.name&&(t=document.querySelector(`select[name="${o.name}"]`),console.log("Hidden select by name:",!!t)),!t&&o.id){const e=o.id.replace("input","select").replace("_input","");t=document.querySelector(`select[id*="${e}"]`),console.log("Hidden select by ID pattern:",!!t)}if(!t){const e=o.closest('[class*="field"], [class*="form"], [class*="input"]');e&&(t=e.querySelector("select"),console.log("Hidden select in container:",!!t))}if(!t){const e=o.getAttribute("data-value")||o.getAttribute("data-selected")||o.getAttribute("aria-label");e&&(n=e,console.log("Using data attribute value:",n))}if(t)if(console.log("Hidden select details:",{selectedIndex:t.selectedIndex,optionsCount:t.options.length,allOptions:Array.from(t.options).map((e,t)=>({index:t,text:e.text,value:e.value}))}),t.selectedIndex>0){const e=t.options[t.selectedIndex];n=e.text||e.value,console.log("Using hidden select value:",n)}else console.log("Hidden select index is 0 (placeholder)")}if(o instanceof HTMLSelectElement){console.log("Element is a SELECT");const e=o,t=e.options[e.selectedIndex];console.log("Select details:",{selectedIndex:e.selectedIndex,selectedText:t?.text,selectedValue:t?.value}),t&&t.text&&(n=t.text)}if(console.log("Final value:",n),!n||!n.trim()){console.log("No value found, prompting user...");const t=prompt(`Enter the value for "${e.context}":`);if(!t||!t.trim())return void this.showToast("âš ï¸ No value entered","warning");n=t.trim(),console.log("User entered value:",n)}const s=n.toLowerCase().trim(),i=["select","select...","please select","choose","choose...","--","select one"].includes(s);if(console.log("Validation:",{value:n,isPlaceholder:i}),i)return void this.showToast("âš ï¸ Please select a valid option","warning");const r=this.generateKey(e.context);await this.storage.addAnswer(r,n,!1),t.innerHTML="âœ… Saved!",t.style.background="#4CAF50",this.formFiller.highlightFieldGreen(o),this.showToast(`âœ… Saved "${r}"`,"success"),setTimeout(()=>{t.remove()},2e3)}showToast(e,t){const o=document.querySelectorAll(".magicfill-toast");o.length>=3&&o[0].remove();let n=20;o.forEach(e=>{const t=e.getBoundingClientRect();n+=t.height+10});const s=document.createElement("div");s.className=`magicfill-toast magicfill-${t}`,s.textContent=e,s.style.cssText=`\n      position: fixed;\n      bottom: ${n}px;\n      right: 20px;\n      padding: 12px 20px;\n      background: ${"success"===t?"#4CAF50":"warning"===t?"#FF9800":"#f44336"};\n      color: white;\n      border-radius: 6px;\n      box-shadow: 0 4px 12px rgba(0,0,0,0.3);\n      z-index: 999999;\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n      font-size: 14px;\n      font-weight: 500;\n      max-width: 300px;\n      transition: all 0.3s ease-out;\n    `,document.body.appendChild(s),setTimeout(()=>{s.style.opacity="1",s.style.transform="translateY(0)"},10),setTimeout(()=>{s.style.opacity="0",s.style.transform="translateX(400px)",setTimeout(()=>s.remove(),300)},3e3)}getUnrecognizedFields(){return this.lastFillResult?this.lastFillResult.unrecognized.map(e=>({selector:e.selector,context:e.context,type:e.type,fieldType:e.fieldType,inputType:e.inputType})):this.fieldMatcher.findAllFields().filter(e=>!e.type||"unknown"===e.type).map(e=>({selector:e.selector,context:e.context,type:e.type,fieldType:e.fieldType,inputType:e.inputType}))}async fillSingleField(e,t){try{const o=document.querySelector(e);if(!o)return{success:!1,error:"Element not found"};const n={element:o,selector:e,type:"unknown",context:this.fieldMatcher.getFieldContext(o),value:o.value||"",fieldType:o.tagName.toLowerCase(),inputType:o instanceof HTMLInputElement?o.type:void 0};return{success:this.formFiller.fillField(n,t)}}catch(e){return{success:!1,error:String(e)}}}showNotification(e,t){const o=document.createElement("div");o.className=`magicfill-notification magicfill-${t}`,o.textContent=e,o.style.cssText=`\n      position: fixed;\n      top: 20px;\n      right: 20px;\n      padding: 12px 20px;\n      background: ${"success"===t?"#4CAF50":"info"===t?"#2196F3":"#f44336"};\n      color: white;\n      border-radius: 4px;\n      box-shadow: 0 2px 8px rgba(0,0,0,0.2);\n      z-index: 999999;\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n      font-size: 14px;\n      animation: slideIn 0.3s ease-out;\n    `,document.body.appendChild(o),setTimeout(()=>{o.style.animation="slideOut 0.3s ease-out",setTimeout(()=>o.remove(),300)},3e3)}observeDynamicForms(){new MutationObserver(e=>{for(const t of e)if(t.addedNodes.length>0&&Array.from(t.addedNodes).some(e=>e instanceof HTMLElement&&(e.matches("input, textarea, select")||e.querySelector("input, textarea, select")))){setTimeout(()=>this.autoFill(),500);break}}).observe(document.body,{childList:!0,subtree:!0})}}})();
//# sourceMappingURL=content.js.map