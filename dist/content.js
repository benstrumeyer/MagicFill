(()=>{"use strict";class e{constructor(){this.patterns=[{type:"firstName",patterns:[/first.*name/i,/fname/i,/given.*name/i],priority:10},{type:"lastName",patterns:[/last.*name/i,/lname/i,/surname/i,/family.*name/i],priority:10},{type:"fullName",patterns:[/^name$/i,/full.*name/i,/your.*name/i],priority:9},{type:"email",patterns:[/email/i,/e-mail/i],priority:10},{type:"phone",patterns:[/phone/i,/mobile/i,/telephone/i,/contact.*number/i],priority:10},{type:"address",patterns:[/^address$/i,/street.*address/i,/address.*line.*1/i],priority:10},{type:"address2",patterns:[/address.*line.*2/i,/apt/i,/suite/i,/unit/i],priority:9},{type:"city",patterns:[/city/i,/town/i],priority:10},{type:"state",patterns:[/state/i,/province/i,/region/i],priority:10},{type:"zipCode",patterns:[/zip/i,/postal/i,/postcode/i],priority:10},{type:"country",patterns:[/country/i],priority:10},{type:"currentCompany",patterns:[/current.*company/i,/employer/i,/organization/i],priority:9},{type:"currentTitle",patterns:[/current.*title/i,/job.*title/i,/position/i,/role/i],priority:9},{type:"yearsExperience",patterns:[/years.*experience/i,/experience.*years/i,/yoe/i],priority:9},{type:"linkedin",patterns:[/linkedin/i,/linkedin.*url/i,/linkedin.*profile/i],priority:10},{type:"github",patterns:[/github/i,/github.*url/i,/github.*profile/i],priority:10},{type:"portfolio",patterns:[/portfolio/i,/website/i,/personal.*site/i],priority:9},{type:"university",patterns:[/university/i,/college/i,/school/i,/education/i],priority:9},{type:"degree",patterns:[/degree/i,/qualification/i],priority:9},{type:"major",patterns:[/major/i,/field.*study/i,/specialization/i],priority:9},{type:"graduationYear",patterns:[/graduation/i,/grad.*year/i,/year.*graduated/i],priority:9},{type:"workAuthorization",patterns:[/work.*authorization/i,/authorized.*work/i,/visa.*status/i,/sponsorship/i],priority:9},{type:"requiresSponsorship",patterns:[/require.*sponsorship/i,/need.*sponsorship/i,/visa.*sponsorship/i],priority:9},{type:"salaryExpectation",patterns:[/salary/i,/compensation/i,/expected.*salary/i],priority:8},{type:"startDate",patterns:[/start.*date/i,/available.*date/i,/availability/i],priority:8},{type:"noticePeriod",patterns:[/notice.*period/i,/notice/i],priority:8},{type:"referral",patterns:[/referral/i,/referred.*by/i,/reference/i],priority:8},{type:"howDidYouHear",patterns:[/how.*hear/i,/source/i,/where.*find/i],priority:7},{type:"coverLetter",patterns:[/cover.*letter/i,/why.*interested/i,/tell.*us.*about/i],priority:7},{type:"additionalInfo",patterns:[/additional/i,/other.*information/i,/comments/i,/notes/i],priority:6}]}getFieldContext(e){const t=[];if(e.id){const i=document.querySelector(`label[for="${e.id}"]`);i?.textContent&&t.push(i.textContent.trim())}const i=e.getAttribute("aria-label");i&&t.push(i),"placeholder"in e&&e.placeholder&&t.push(e.placeholder),e.name&&t.push(e.name),e.id&&t.push(e.id);const r=e.closest("label");return r?.textContent&&t.push(r.textContent.replace(e.value||"","").trim()),t.join(" ")}matchField(e){let t=null;for(const i of this.patterns)for(const r of i.patterns)r.test(e)&&(!t||i.priority>t.priority)&&(t={type:i.type,priority:i.priority});return t?.type||null}findAllFields(){const e=[];return document.querySelectorAll('input:not([type="hidden"]):not([type="submit"]):not([type="button"]), textarea, select').forEach(t=>{const i=t;if(i.disabled)return;if("readOnly"in i&&i.readOnly)return;const r=this.getFieldContext(i),n=this.matchField(r),s=this.generateSelector(i);e.push({element:i,selector:s,type:n||"unknown",context:r,value:i.value||"",fieldType:i.tagName.toLowerCase(),inputType:i instanceof HTMLInputElement?i.type:void 0})}),e}generateSelector(e){if(e.id)return`#${e.id}`;if(e instanceof HTMLInputElement&&e.name)return`input[name="${e.name}"]`;if(e instanceof HTMLTextAreaElement&&e.getAttribute("name"))return`textarea[name="${e.getAttribute("name")}"]`;if(e instanceof HTMLSelectElement&&e.name)return`select[name="${e.name}"]`;const t=e.parentElement;if(t){const i=Array.from(t.children).filter(t=>t.tagName===e.tagName).indexOf(e)+1;return`${e.tagName.toLowerCase()}:nth-of-type(${i})`}return e.tagName.toLowerCase()}}class t{fillField(e,t){try{const i=e.element;return!(!i||i.disabled)&&(!("readOnly"in i)||!i.readOnly)&&(i instanceof HTMLInputElement?this.fillInput(i,t):i instanceof HTMLTextAreaElement?this.fillTextarea(i,t):i instanceof HTMLSelectElement&&this.fillSelect(i,t))}catch(e){return console.error("Error filling field:",e),!1}}fillInput(e,t){switch(e.type){case"text":case"email":case"tel":case"url":case"number":case"date":return e.value=String(t),this.triggerEvents(e),this.highlightField(e),!0;case"checkbox":return e.checked=Boolean(t),this.triggerEvents(e),this.highlightField(e),!0;case"radio":return e.value===String(t)&&(e.checked=!0,this.triggerEvents(e),this.highlightField(e),!0);default:return!1}}fillTextarea(e,t){return e.value=t,this.triggerEvents(e),this.highlightField(e),!0}fillSelect(e,t){for(let i=0;i<e.options.length;i++){const r=e.options[i];if(r.value===t||r.text===t)return e.selectedIndex=i,this.triggerEvents(e),this.highlightField(e),!0}const i=t.toLowerCase();for(let t=0;t<e.options.length;t++){const r=e.options[t];if(r.value.toLowerCase().includes(i)||r.text.toLowerCase().includes(i))return e.selectedIndex=t,this.triggerEvents(e),this.highlightField(e),!0}return!1}triggerEvents(e){e.dispatchEvent(new Event("input",{bubbles:!0})),e.dispatchEvent(new Event("change",{bubbles:!0})),e.dispatchEvent(new Event("blur",{bubbles:!0}))}highlightField(e){const t=e.style.border,i=e.style.backgroundColor;e.style.border="2px solid #4CAF50",e.style.backgroundColor="#E8F5E9",setTimeout(()=>{e.style.border=t,e.style.backgroundColor=i},1e3)}fillAllFields(e,t){let i=0;const r=[];for(const n of e){if(!n.type||"unknown"===n.type){r.push(n);continue}const e=this.getValueForField(n.type,t);null!=e?this.fillField(n,e)&&i++:r.push(n)}return{filled:i,total:e.length,unrecognized:r}}getValueForField(e,t){if(t.customAnswers&&t.customAnswers[e])return t.customAnswers[e];switch(e){case"firstName":return t.firstName;case"lastName":return t.lastName;case"fullName":return`${t.firstName} ${t.lastName}`;case"email":return t.email;case"phone":return t.phone;case"address":return t.address;case"address2":return t.address2||"";case"city":return t.city;case"state":return t.state;case"zipCode":return t.zipCode;case"country":return t.country;case"currentCompany":return t.currentCompany||"";case"currentTitle":return t.currentTitle||"";case"yearsExperience":return t.yearsExperience?.toString()||"";case"linkedin":return t.linkedin||"";case"github":return t.github||"";case"portfolio":return t.portfolio||"";case"university":return t.university||"";case"degree":return t.degree||"";case"major":return t.major||"";case"graduationYear":return t.graduationYear?.toString()||"";case"workAuthorization":return t.workAuthorization||"";case"requiresSponsorship":return t.requiresSponsorship??!1;case"salaryExpectation":return t.salaryExpectation||"";case"startDate":return t.startDate||"";case"noticePeriod":return t.noticePeriod||"";case"referral":return t.referral||"";case"howDidYouHear":return t.howDidYouHear||"";case"coverLetter":return t.coverLetter||"";case"additionalInfo":return t.additionalInfo||"";default:return null}}}class i{async get(e){return new Promise(t=>{chrome.storage.local.get([e],i=>{t(i[e]||null)})})}async set(e,t){return new Promise(i=>{chrome.storage.local.set({[e]:t},()=>{i()})})}async getPersonalData(){return await this.get("personalData")||this.getDefaultPersonalData()}async setPersonalData(e){await this.set("personalData",e)}async addAnswer(e,t,i=!1){const r=await this.getPersonalData();if(r.customAnswers||(r.customAnswers={}),i){const i=window.location.hostname;r.siteSpecificAnswers||(r.siteSpecificAnswers={}),r.siteSpecificAnswers[i]||(r.siteSpecificAnswers[i]={}),r.siteSpecificAnswers[i][e]=t}else r.customAnswers[e]=t;await this.setPersonalData(r)}getDefaultPersonalData(){return{firstName:"",lastName:"",email:"",phone:"",address:"",address2:"",city:"",state:"",zipCode:"",country:"United States",currentCompany:"",currentTitle:"",yearsExperience:0,linkedin:"",github:"",portfolio:"",university:"",degree:"",major:"",graduationYear:0,workAuthorization:"",requiresSponsorship:!1,salaryExpectation:"",startDate:"",noticePeriod:"",referral:"",howDidYouHear:"",coverLetter:"",additionalInfo:"",customAnswers:{},siteSpecificAnswers:{}}}async exportData(){const e=await this.getPersonalData();return JSON.stringify(e,null,2)}async importData(e){try{const t=JSON.parse(e);await this.setPersonalData(t)}catch(e){throw new Error("Invalid JSON format")}}async deleteAnswer(e,t=!1,i){const r=await this.getPersonalData();t&&i&&r.siteSpecificAnswers?.[i]?delete r.siteSpecificAnswers[i][e]:r.customAnswers&&delete r.customAnswers[e],await this.setPersonalData(r)}}new class{constructor(){this.lastFillResult=null,this.fieldMatcher=new e,this.formFiller=new t,this.storage=new i,this.init()}async init(){chrome.runtime.onMessage.addListener((e,t,i)=>(this.handleMessage(e).then(i),!0)),setTimeout(()=>{this.autoFill()},1e3),this.observeDynamicForms()}async handleMessage(e){const t=e.action;return"fillForm"===t?await this.fillForm():"getUnrecognizedFields"===t?this.getUnrecognizedFields():"fillField"===t?e.payload?.selector&&e.payload?.value?await this.fillSingleField(e.payload.selector,e.payload.value):{success:!1,error:"Missing selector or value"}:"addAnswer"===t?e.payload?.key&&void 0!==e.payload?.value?(await this.storage.addAnswer(e.payload.key,e.payload.value,e.payload.siteSpecific||!1),{success:!0}):{success:!1,error:"Missing key or value"}:{success:!1,error:"Unknown action"}}async autoFill(){try{const e=await this.fillForm();e.filled>0&&this.showNotification(`✨ Filled ${e.filled}/${e.total} fields`,"success"),e.unrecognized.length>0&&this.showNotification(`❓ ${e.unrecognized.length} unrecognized fields`,"info")}catch(e){console.error("Auto-fill error:",e)}}async fillForm(){const e=this.fieldMatcher.findAllFields(),t=await this.storage.getPersonalData(),i=this.formFiller.fillAllFields(e,t);return this.lastFillResult=i,i}getUnrecognizedFields(){return this.lastFillResult?this.lastFillResult.unrecognized.map(e=>({selector:e.selector,context:e.context,type:e.type,fieldType:e.fieldType,inputType:e.inputType})):this.fieldMatcher.findAllFields().filter(e=>!e.type||"unknown"===e.type).map(e=>({selector:e.selector,context:e.context,type:e.type,fieldType:e.fieldType,inputType:e.inputType}))}async fillSingleField(e,t){try{const i=document.querySelector(e);if(!i)return{success:!1,error:"Element not found"};const r={element:i,selector:e,type:"unknown",context:this.fieldMatcher.getFieldContext(i),value:i.value||"",fieldType:i.tagName.toLowerCase(),inputType:i instanceof HTMLInputElement?i.type:void 0};return{success:this.formFiller.fillField(r,t)}}catch(e){return{success:!1,error:String(e)}}}showNotification(e,t){const i=document.createElement("div");i.className=`magicfill-notification magicfill-${t}`,i.textContent=e,i.style.cssText=`\n      position: fixed;\n      top: 20px;\n      right: 20px;\n      padding: 12px 20px;\n      background: ${"success"===t?"#4CAF50":"info"===t?"#2196F3":"#f44336"};\n      color: white;\n      border-radius: 4px;\n      box-shadow: 0 2px 8px rgba(0,0,0,0.2);\n      z-index: 999999;\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n      font-size: 14px;\n      animation: slideIn 0.3s ease-out;\n    `,document.body.appendChild(i),setTimeout(()=>{i.style.animation="slideOut 0.3s ease-out",setTimeout(()=>i.remove(),300)},3e3)}observeDynamicForms(){new MutationObserver(e=>{for(const t of e)if(t.addedNodes.length>0&&Array.from(t.addedNodes).some(e=>e instanceof HTMLElement&&(e.matches("input, textarea, select")||e.querySelector("input, textarea, select")))){setTimeout(()=>this.autoFill(),500);break}}).observe(document.body,{childList:!0,subtree:!0})}}})();
//# sourceMappingURL=content.js.map