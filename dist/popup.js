(()=>{"use strict";class t{constructor(){this.init()}async init(){document.getElementById("fillBtn")?.addEventListener("click",()=>this.fillForm()),document.getElementById("learnBtn")?.addEventListener("click",()=>this.learnForm()),document.getElementById("manageBtn")?.addEventListener("click",()=>this.openManageAnswers()),await this.updateStatus(),setInterval(()=>this.updateStatus(),2e3)}async updateStatus(){try{const[t]=await chrome.tabs.query({active:!0,currentWindow:!0});if(!t.id)return void this.showStatus("‚ö†Ô∏è","No active tab","warning");const e={action:"getUnrecognizedFields"},s=await chrome.tabs.sendMessage(t.id,e);s&&s.length>0?this.showStatus("‚úÖ",`Ready to fill (${s.length} unrecognized)`,"success"):this.showStatus("‚úÖ","All fields recognized","success")}catch(t){this.showStatus("‚ö†Ô∏è","Not a fillable page","warning")}}showStatus(t,e,s){const r=document.getElementById("status");r&&(r.className=`status ${s}`,r.innerHTML=`\n      <div class="status-icon">${t}</div>\n      <div class="status-text">${e}</div>\n    `)}async fillForm(){try{const[t]=await chrome.tabs.query({active:!0,currentWindow:!0});if(!t.id)return;const e={action:"fillForm"},s=await chrome.tabs.sendMessage(t.id,e);s&&(this.showStatus("‚ú®",`Filled ${s.filled}/${s.total} fields`,"success"),await this.updateStatus())}catch(t){this.showStatus("‚ùå","Error filling form","error"),console.error("Fill error:",t)}}async learnForm(){try{const[t]=await chrome.tabs.query({active:!0,currentWindow:!0});if(!t.id)return;this.showStatus("üß†","Learning form...","success");const e={action:"learnForm"},s=await chrome.tabs.sendMessage(t.id,e);s.success?(0===s.fieldsLearned?this.showStatus("‚úÖ","All fields recognized!","success"):(this.showStatus("‚úÖ",`Found ${s.fieldsLearned} new fields!`,"success"),s.openReview&&chrome.tabs.create({url:chrome.runtime.getURL("review-fields.html")})),await this.updateStatus()):this.showStatus("‚ùå",s.error||"Learning failed","error")}catch(t){this.showStatus("‚ùå","MCP server not running","error"),console.error("Learn error:",t)}}openManageAnswers(){chrome.tabs.create({url:chrome.runtime.getURL("manage.html")})}}console.log("popup.ts: Script loaded, creating PopupController...");try{new t,console.log("popup.ts: PopupController created successfully")}catch(t){console.error("popup.ts: Failed to create PopupController:",t);const e=document.querySelector(".container");e&&(e.innerHTML='\n      <div style="padding: 20px;">\n        <h1 style="color: #f44336;">Error</h1>\n        <p>Failed to initialize popup. Check console for details.</p>\n      </div>\n    ')}})();
//# sourceMappingURL=popup.js.map