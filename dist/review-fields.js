(()=>{"use strict";class e{async get(e){return new Promise(t=>{chrome.storage.local.get([e],s=>{t(s[e]||null)})})}async set(e,t){return new Promise(s=>{chrome.storage.local.set({[e]:t},()=>{s()})})}async getPersonalData(){const e=await this.get("personalData");if(!e||0===Object.keys(e).length||!e.firstName){const e=await this.loadDevData();if(e)return console.log("Storage: Loaded dev-data.json for testing"),await this.setPersonalData(e),e}const t=e||this.getDefaultPersonalData();return t.fieldMappings||(t.fieldMappings=await this.loadFieldMappings()),t}async loadFieldMappings(){try{const e=await fetch(chrome.runtime.getURL("field-mappings.json"));if(e.ok){const t=await e.json();return console.log("Storage: Loaded field-mappings.json"),t}}catch(e){console.log("Storage: No field-mappings.json found")}return{}}async loadDevData(){try{const e=await fetch(chrome.runtime.getURL("dev-data.json"));if(e.ok)return await e.json()}catch(e){console.log("Storage: No dev-data.json found (this is normal for production)")}return null}async setPersonalData(e){await this.set("personalData",e)}async addAnswer(e,t,s=!1){const n=await this.getPersonalData();if(n.customAnswers||(n.customAnswers={}),s){const s=window.location.hostname;n.siteSpecificAnswers||(n.siteSpecificAnswers={}),n.siteSpecificAnswers[s]||(n.siteSpecificAnswers[s]={}),n.siteSpecificAnswers[s][e]=t}else n.customAnswers[e]=t;await this.setPersonalData(n)}getDefaultPersonalData(){return{firstName:"",lastName:"",email:"",phone:"",address:"",address2:"",city:"",state:"",zipCode:"",country:"United States",currentCompany:"",currentTitle:"",yearsExperience:0,linkedin:"",github:"",portfolio:"",university:"",degree:"",major:"",graduationYear:0,workAuthorization:"",requiresSponsorship:!1,salaryExpectation:"",startDate:"",noticePeriod:"",referral:"",howDidYouHear:"",coverLetter:"",additionalInfo:"",customAnswers:{},siteSpecificAnswers:{}}}async exportData(){const e=await this.getPersonalData();return JSON.stringify(e,null,2)}async importData(e){try{const t=JSON.parse(e);await this.setPersonalData(t)}catch(e){throw new Error("Invalid JSON format")}}async deleteAnswer(e,t=!1,s){const n=await this.getPersonalData();t&&s&&n.siteSpecificAnswers?.[s]?delete n.siteSpecificAnswers[s][e]:n.customAnswers&&delete n.customAnswers[e],await this.setPersonalData(n)}}console.log("review-fields.ts: Initializing..."),new class{constructor(){this.fields=[],this.storage=new e,this.init()}async init(){const e=sessionStorage.getItem("learnedFields");e?(this.fields=JSON.parse(e),this.renderFields(),document.getElementById("cancelBtn")?.addEventListener("click",()=>window.close()),document.getElementById("saveBtn")?.addEventListener("click",()=>this.saveAllAnswers())):document.body.innerHTML='\n        <div style="padding: 20px; text-align: center;">\n          <h2>No fields to review</h2>\n          <p>Click "Learn Form" first to scan a page.</p>\n        </div>\n      '}renderFields(){const e=document.getElementById("fieldsList"),t=document.getElementById("fieldCount");e&&t&&(t.textContent=`${this.fields.length} field${1!==this.fields.length?"s":""} to review`,e.innerHTML="",this.fields.forEach((t,s)=>{const n=document.createElement("div");n.className="learned-field",n.innerHTML=`\n        <div class="field-details">\n          <div class="field-label">${this.generateLabel(t.key)}</div>\n          <div class="field-context">${t.context}</div>\n          <input \n            type="text" \n            class="field-input" \n            data-index="${s}"\n            placeholder="Enter your answer..."\n            value="${t.value}"\n          >\n        </div>\n        <button class="remove-btn" data-index="${s}">−</button>\n      `;const a=n.querySelector(".field-input");a?.addEventListener("input",e=>{this.fields[s].value=e.target.value});const i=n.querySelector(".remove-btn");i?.addEventListener("click",()=>{this.removeField(s)}),e.appendChild(n)}))}removeField(e){this.fields.splice(e,1),this.renderFields()}async saveAllAnswers(){let e=0;for(const t of this.fields)t.value.trim()&&(await this.storage.addAnswer(t.key,t.value,!1),e++);sessionStorage.removeItem("learnedFields"),alert(`✅ Saved ${e} answer${1!==e?"s":""}!`),window.close()}generateLabel(e){return e.replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase()).trim()}}})();
//# sourceMappingURL=review-fields.js.map