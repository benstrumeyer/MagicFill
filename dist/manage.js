(()=>{"use strict";class e{async get(e){return new Promise(t=>{chrome.storage.local.get([e],s=>{t(s[e]||null)})})}async set(e,t){return new Promise(s=>{chrome.storage.local.set({[e]:t},()=>{s()})})}async getPersonalData(){return await this.get("personalData")||this.getDefaultPersonalData()}async setPersonalData(e){await this.set("personalData",e)}async addAnswer(e,t,s=!1){const a=await this.getPersonalData();if(a.customAnswers||(a.customAnswers={}),s){const s=window.location.hostname;a.siteSpecificAnswers||(a.siteSpecificAnswers={}),a.siteSpecificAnswers[s]||(a.siteSpecificAnswers[s]={}),a.siteSpecificAnswers[s][e]=t}else a.customAnswers[e]=t;await this.setPersonalData(a)}getDefaultPersonalData(){return{firstName:"",lastName:"",email:"",phone:"",address:"",address2:"",city:"",state:"",zipCode:"",country:"United States",currentCompany:"",currentTitle:"",yearsExperience:0,linkedin:"",github:"",portfolio:"",university:"",degree:"",major:"",graduationYear:0,workAuthorization:"",requiresSponsorship:!1,salaryExpectation:"",startDate:"",noticePeriod:"",referral:"",howDidYouHear:"",coverLetter:"",additionalInfo:"",customAnswers:{},siteSpecificAnswers:{}}}async exportData(){const e=await this.getPersonalData();return JSON.stringify(e,null,2)}async importData(e){try{const t=JSON.parse(e);await this.setPersonalData(t)}catch(e){throw new Error("Invalid JSON format")}}async deleteAnswer(e,t=!1,s){const a=await this.getPersonalData();t&&s&&a.siteSpecificAnswers?.[s]?delete a.siteSpecificAnswers[s][e]:a.customAnswers&&delete a.customAnswers[e],await this.setPersonalData(a)}}window.closeImportModal=()=>{const e=document.getElementById("importModal");e&&(e.style.display="none")},new class{constructor(){this.personalData=null,this.searchQuery="",this.storage=new e,this.init()}async init(){this.personalData=await this.storage.getPersonalData(),this.setupEventListeners(),this.loadPersonalDataTab(),this.updateStats()}setupEventListeners(){document.querySelectorAll(".tab-btn").forEach(e=>{e.addEventListener("click",e=>{const t=e.target.dataset.tab;t&&this.switchTab(t)})}),document.getElementById("searchInput")?.addEventListener("input",e=>{this.searchQuery=e.target.value.toLowerCase(),this.filterAnswers()}),document.getElementById("savePersonalBtn")?.addEventListener("click",()=>this.savePersonalData()),document.getElementById("exportBtn")?.addEventListener("click",()=>this.exportData()),document.getElementById("importBtn")?.addEventListener("click",()=>this.showImportModal()),document.getElementById("confirmImportBtn")?.addEventListener("click",()=>this.importData()),document.getElementById("addCustomBtn")?.addEventListener("click",()=>this.addCustomAnswer())}switchTab(e){document.querySelectorAll(".tab-btn").forEach(t=>{t.classList.toggle("active",t.getAttribute("data-tab")===e)}),document.querySelectorAll(".tab-pane").forEach(e=>{e.classList.remove("active")});const t={personal:"personalTab",custom:"customTab","site-specific":"siteSpecificTab"}[e];t&&(document.getElementById(t)?.classList.add("active"),"custom"===e&&this.loadCustomAnswers(),"site-specific"===e&&this.loadSiteSpecificAnswers())}loadPersonalDataTab(){this.personalData&&document.querySelectorAll(".personal-field").forEach(e=>{const t=e,s=t.dataset.field;if(s&&this.personalData){const e=this.personalData[s];t instanceof HTMLSelectElement?t.value=String(e):t.value=null!=e?String(e):""}})}async savePersonalData(){this.personalData&&(document.querySelectorAll(".personal-field").forEach(e=>{const t=e,s=t.dataset.field;if(s&&this.personalData){let e=t.value;"yearsExperience"===s||"graduationYear"===s?e=e?parseInt(e):void 0:"requiresSponsorship"===s&&(e="true"===e),this.personalData[s]=e}}),await this.storage.setPersonalData(this.personalData),this.showSuccessMessage("Personal data saved successfully!"))}loadCustomAnswers(){if(!this.personalData?.customAnswers)return;const e=document.getElementById("customAnswersList");if(!e)return;e.innerHTML="";const t=Object.entries(this.personalData.customAnswers);0!==t.length?t.forEach(([t,s])=>{const a=document.createElement("div");a.className="answer-item",a.innerHTML=`\n        <div class="answer-info">\n          <div class="answer-key">${t}</div>\n          <div class="answer-value">${this.truncate(String(s),100)}</div>\n        </div>\n        <div class="answer-actions">\n          <button class="icon-btn edit-btn" data-key="${t}">âœï¸</button>\n          <button class="icon-btn delete-btn" data-key="${t}">ğŸ—‘ï¸</button>\n        </div>\n      `,a.querySelector(".edit-btn")?.addEventListener("click",()=>this.editCustomAnswer(t)),a.querySelector(".delete-btn")?.addEventListener("click",()=>this.deleteCustomAnswer(t)),e.appendChild(a)}):e.innerHTML='\n        <div class="empty-state">\n          <div class="empty-state-icon">ğŸ“</div>\n          <div class="empty-state-text">No custom answers yet</div>\n        </div>\n      '}loadSiteSpecificAnswers(){if(!this.personalData?.siteSpecificAnswers)return;const e=document.getElementById("sitesList");if(!e)return;e.innerHTML="";const t=Object.entries(this.personalData.siteSpecificAnswers);0!==t.length?t.forEach(([t,s])=>{const a=document.createElement("div");a.className="site-section";const n=document.createElement("div");n.className="site-header",n.textContent=t,a.appendChild(n);const i=document.createElement("div");i.className="answers-list",Object.entries(s).forEach(([e,s])=>{const a=document.createElement("div");a.className="answer-item",a.innerHTML=`\n          <div class="answer-info">\n            <div class="answer-key">${e}</div>\n            <div class="answer-value">${this.truncate(String(s),100)}</div>\n          </div>\n          <div class="answer-actions">\n            <button class="icon-btn delete-btn" data-hostname="${t}" data-key="${e}">ğŸ—‘ï¸</button>\n          </div>\n        `,a.querySelector(".delete-btn")?.addEventListener("click",()=>{this.deleteSiteSpecificAnswer(t,e)}),i.appendChild(a)}),a.appendChild(i),e.appendChild(a)}):e.innerHTML='\n        <div class="empty-state">\n          <div class="empty-state-icon">ğŸŒ</div>\n          <div class="empty-state-text">No site-specific answers yet</div>\n        </div>\n      '}async addCustomAnswer(){const e=prompt("Enter answer key (e.g., preferredWorkLocation):");if(!e)return;const t=prompt("Enter answer value:");t&&(await this.storage.addAnswer(e,t,!1),this.personalData=await this.storage.getPersonalData(),this.loadCustomAnswers(),this.updateStats(),this.showSuccessMessage("Custom answer added!"))}async editCustomAnswer(e){const t=this.personalData?.customAnswers?.[e],s=prompt("Edit answer value:",String(t));null!==s&&(await this.storage.addAnswer(e,s,!1),this.personalData=await this.storage.getPersonalData(),this.loadCustomAnswers(),this.showSuccessMessage("Answer updated!"))}async deleteCustomAnswer(e){confirm(`Delete answer "${e}"?`)&&(await this.storage.deleteAnswer(e,!1),this.personalData=await this.storage.getPersonalData(),this.loadCustomAnswers(),this.updateStats(),this.showSuccessMessage("Answer deleted!"))}async deleteSiteSpecificAnswer(e,t){confirm(`Delete answer "${t}" for ${e}?`)&&(await this.storage.deleteAnswer(t,!0,e),this.personalData=await this.storage.getPersonalData(),this.loadSiteSpecificAnswers(),this.updateStats(),this.showSuccessMessage("Answer deleted!"))}filterAnswers(){document.querySelectorAll(".answer-item").forEach(e=>{const t=(e.textContent?.toLowerCase()||"").includes(this.searchQuery);e.style.display=t?"flex":"none"})}async exportData(){const e=await this.storage.exportData(),t=new Blob([e],{type:"application/json"}),s=URL.createObjectURL(t),a=document.createElement("a");a.href=s,a.download=`magicfill-data-${Date.now()}.json`,a.click(),URL.revokeObjectURL(s),this.showSuccessMessage("Data exported!")}showImportModal(){const e=document.getElementById("importModal");e&&(e.style.display="flex")}async importData(){const e=document.getElementById("importJson");if(e)try{await this.storage.importData(e.value),this.personalData=await this.storage.getPersonalData(),this.loadPersonalDataTab(),this.updateStats(),this.closeImportModal(),this.showSuccessMessage("Data imported successfully!")}catch(e){alert("Invalid JSON format. Please check your data and try again.")}}closeImportModal(){const e=document.getElementById("importModal");e&&(e.style.display="none")}updateStats(){if(!this.personalData)return;const e=Object.keys(this.personalData.customAnswers||{}).length,t=Object.keys(this.personalData.siteSpecificAnswers||{}).length,s=document.getElementById("totalAnswers"),a=document.getElementById("sitesConfigured");s&&(s.textContent=String(e)),a&&(a.textContent=String(t))}showSuccessMessage(e){const t=document.createElement("div");t.className="success-message",t.textContent=e,document.body.appendChild(t),setTimeout(()=>{t.remove()},3e3)}truncate(e,t){return e.length<=t?e:e.substring(0,t)+"..."}}})();
//# sourceMappingURL=manage.js.map